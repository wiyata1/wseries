<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dailymotion Playlist Sheets</title>

<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial;
}
#list a {
  display: block;
  padding: 12px;
  border-bottom: 1px solid #444;
  color: white;
  text-decoration: none;
}
iframe {
  width: 100%;
  height: 50vh;
  border: 0;
}
</style>
</head>

<body>

<div id="list">Cargando lista...</div>

<iframe id="player" allowfullscreen webkitallowfullscreen></iframe>

<script>
// ===============================
// GOOGLE SHEETS (GVIZ + JSONP)
// ===============================
var SHEET_GVIZ =
'https://docs.google.com/spreadsheets/d/2PACX-1vRMQ57z3YKiInRARJk1hbw2tsaa6vM4074Pnw3T08GdL-DGtOuY-yhjgJxq_iCVMGMbDJvqiz8qfwY7/gviz/tq?gid=467389284';

// Columna C = Ã­ndice 2
var COL_URL = 2;

// ===============================
// CALLBACK
// ===============================
function sheetLoaded(data) {
  if (!data || !data.table || !data.table.rows) {
    document.getElementById('list').innerHTML =
      'Error al cargar lista';
    return;
  }

  var rows = data.table.rows;
  var html = '';

  for (var i = 0; i < rows.length; i++) {
    if (!rows[i].c || !rows[i].c[COL_URL]) continue;
    var url = rows[i].c[COL_URL].v;
    if (!url) continue;

    html +=
      '<a href="javascript:void(0)" onclick="play(\'' + url + '\')">' +
      'Playlist ' + (i + 1) +
      '</a>';
  }

  document.getElementById('list').innerHTML =
    html || 'No hay playlists';
}

// ===============================
// CARGAR JSONP
// ===============================
(function () {
  var s = document.createElement('script');
  s.src = SHEET_GVIZ +
    '&tqx=responseHandler:sheetLoaded';
  document.body.appendChild(s);
})();

// ===============================
// PLAYLIST
// ===============================
function play(url) {
  var embed = url.replace(
    'https://www.dailymotion.com/',
    'https://www.dailymotion.com/embed/'
  );
  document.getElementById('player').src = embed;
}
</script>

</body>
</html>
